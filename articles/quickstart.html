<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quickstart with vbar • vbar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quickstart with vbar">
<meta property="og:description" content="vbar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vbar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/quickstart.html">Quickstart with vbar</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quickstart with vbar</h1>
                        <h4 data-toc-skip class="author">Michael
Koohafkan</h4>
            
      
      
      <div class="hidden name"><code>quickstart.rmd</code></div>

    </div>

    
    
<p>The <code>vbar</code> package provides an approach to calling VBA
Macros from R. At its core, the package provides methods for
programatically constructing VBScript files that can be called from the
shell, e.g., via <code><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">vbar</span><span class="op">)</span></span></code></pre></div>
<p>Scripts are generated from a skeleton script with placeholders for
macro-specific information. The package includes a default skeleton
script for basic usage, but custom skeleton scripts can be used
instead:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/default_skeleton.html">default_skeleton</a></span><span class="op">(</span>print <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Option Explicit</span></span>
<span><span class="co">## On Error Resume Next</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Dim args</span></span>
<span><span class="co">## Set args = wScript.Arguments</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## {dim_args}</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## {assign_args}</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Dim macroApp</span></span>
<span><span class="co">## Dim macroFile</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Set macroApp = createObject("{macro_application}.Application")</span></span>
<span><span class="co">## macroApp.visible = False</span></span>
<span><span class="co">## Set macroFile = macroApp.{collection_type}.Open("{macro_file}")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## If Err.Number &lt;&gt; 0 Then</span></span>
<span><span class="co">##   WScript.Echo "VBScript Error: " &amp; Err.Description</span></span>
<span><span class="co">##   macroApp.Quit</span></span>
<span><span class="co">##   wscript.quit</span></span>
<span><span class="co">## End If</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## macroApp.Run "{macro_name}", {macro_args}</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## If Err.Number &lt;&gt; 0 Then</span></span>
<span><span class="co">##   WScript.Echo "VBScript Error: " &amp; Err.Description</span></span>
<span><span class="co">##   macroApp.Quit</span></span>
<span><span class="co">##   wscript.quit</span></span>
<span><span class="co">## End If</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## macroFile.Close</span></span>
<span><span class="co">## macroApp.Quit</span></span></code></pre>
<pre><code><span><span class="co">## [1] "C:/LocalWorkspace/g2encmck/Repositories/vbar/inst/scripts/skeleton.vbs"</span></span></code></pre>
<p>The package provides two methods for interfacing with VBA macros. To
illustrate these methods, we’ll use a macro-enabled Excel workbook
“data_importer.xlsm”. This file contains a single macro “importData”
which copies data from a csv file to a sheet and cell specified by the
user and saves the result to a new Excel file. For reference, the macro
VBA code is included below:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>importData(inputFile <span class="kw">As</span> <span class="dt">String</span>, sheetName <span class="kw">As</span> <span class="dt">String</span>, tableRange <span class="kw">As</span> <span class="dt">String</span>, outputFile <span class="kw">As</span> <span class="dt">String</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">'declarations</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> wsheet <span class="kw">As</span> Worksheet</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Set </span>wsheet = ActiveWorkbook.Sheets(sheetName)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">'read data from file</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    With wsheet.QueryTables.Add(Connection:=<span class="st">"TEXT;"</span> &amp; inputFile, Destination:=wsheet.Range(tableRange))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        .TextFileParseType = xlDelimited</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        .TextFileCommaDelimiter = <span class="kw">True</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        .RefreshOnFileOpen = <span class="kw">False</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        .Refresh BackgroundQuery:=<span class="kw">False</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        .Refresh</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    End With</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">'remove connection when finished</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> Conn <span class="kw">As</span> WorkbookConnection</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">For </span>Each Conn In ThisWorkbook.Connections</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">If </span>InStr(1, inputFile, Conn.Name, 1) &gt; 0 <span class="kw">Then</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            Conn.Delete</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">End If</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Next </span>Conn</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    ActiveWorkbook.SaveAs (outputFile)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span></code></pre></div>
<p>This macro file is included in the package. <strong>Note:</strong>
that if you have macros disabled by default on your machine, you may
need to re-sign the Excel file.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get path to data_importer.xlsm</span></span>
<span><span class="va">example_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"data_importer.xlsm"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"vbar"</span><span class="op">)</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># navigate to the file and re-sign if necessary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">example_file</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "C:\\LocalWorkspace\\g2encmck\\Repositories\\vbar\\inst\\examples\\data_importer.xlsm"</span></span></code></pre>
<p>The macro accepts four arguments: 1. The path to the csv file
containing data 2. The target sheet in “data_importer.xlsm” to write
data to 3. The target cell defining the top-left corner of the data
table to be written. 4. The path of the new Excel file to be saved.</p>
<p>For this example, we’ll also create some dummy data to import.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create dummy data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">dummy_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".csv"</span><span class="op">)</span>, mustWork <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>, <span class="va">dummy_file</span>,</span>
<span>  row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="generate-a-script-file-from-a-list-of-arguments">1. Generate a script file from a list of arguments<a class="anchor" aria-label="anchor" href="#generate-a-script-file-from-a-list-of-arguments"></a>
</h3>
<p>This method produces a VBS script that calls the specified macro. All
arguments to the macro must be passed as named R arguments with default
values in order to perform the correct type casting in the resulting
VBScript.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myscript</span> <span class="op">=</span> <span class="fu"><a href="../reference/macro_script.html">macro_script</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="st">"importData"</span>,</span>
<span>  inputFile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, targetSheet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, outputFile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">myscript</span></span></code></pre></div>
<pre><code><span><span class="co">## Option Explicit</span></span>
<span><span class="co">## On Error Resume Next</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Dim args</span></span>
<span><span class="co">## Set args = wScript.Arguments</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Dim inputFile</span></span>
<span><span class="co">## Dim targetSheet</span></span>
<span><span class="co">## Dim targetRange</span></span>
<span><span class="co">## Dim outputFile</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## inputFile = args(0)</span></span>
<span><span class="co">## targetSheet = args(1)</span></span>
<span><span class="co">## targetRange = args(2)</span></span>
<span><span class="co">## outputFile = args(3)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Dim macroApp</span></span>
<span><span class="co">## Dim macroFile</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Set macroApp = createObject("Excel.Application")</span></span>
<span><span class="co">## macroApp.visible = False</span></span>
<span><span class="co">## Set macroFile = macroApp.Workbooks.Open("C:\LocalWorkspace\g2encmck\Repositories\vbar\inst\examples\data_importer.xlsm")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## If Err.Number &lt;&gt; 0 Then</span></span>
<span><span class="co">##   WScript.Echo "VBScript Error: " &amp; Err.Description</span></span>
<span><span class="co">##   macroApp.Quit</span></span>
<span><span class="co">##   wscript.quit</span></span>
<span><span class="co">## End If</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## macroApp.Run "importData", CStr(inputFile), CStr(targetSheet), CStr(targetRange), CStr(outputFile)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## If Err.Number &lt;&gt; 0 Then</span></span>
<span><span class="co">##   WScript.Echo "VBScript Error: " &amp; Err.Description</span></span>
<span><span class="co">##   macroApp.Quit</span></span>
<span><span class="co">##   wscript.quit</span></span>
<span><span class="co">## End If</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## macroFile.Close</span></span>
<span><span class="co">## macroApp.Quit</span></span></code></pre>
<p>This script can then be written to a file and run via
<code><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># write script to file</span></span>
<span><span class="va">script_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".vbs"</span><span class="op">)</span>, mustWork <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">myscript</span>, <span class="va">script_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#specify macro output file</span></span>
<span><span class="va">output_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xlsm"</span><span class="op">)</span>, mustWork <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run macro via VBScript</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2</a></span><span class="op">(</span><span class="st">"cscript"</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">script_file</span>, <span class="va">dummy_file</span>, <span class="st">"second_sheet"</span>,</span>
<span>  <span class="st">"B2"</span>, <span class="va">output_file</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>When you open the resulting Excel file, you should see the dummy data
written to sheet “second_sheet” starting at cell B2.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">shell.exec</span><span class="op">(</span><span class="va">output_file</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-an-r-function-that-calls-the-script-file">2. Generate an R function that calls the script file<a class="anchor" aria-label="anchor" href="#generate-an-r-function-that-calls-the-script-file"></a>
</h3>
<p>This method wraps the functionality of the previous method into a
callable R function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macro_fun</span> <span class="op">=</span> <span class="fu"><a href="../reference/macro_function.html">macro_function</a></span><span class="op">(</span><span class="va">example_file</span>, <span class="st">"importData"</span>,</span>
<span>  dataFile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, targetSheet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  targetRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, outputFile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>VBScripts created by <code><a href="../reference/macro_function.html">macro_function()</a></code> are stored in a
temporary directory managed by the package. The VBScript file names
match the specified macro names.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/script_dir.html">script_dir</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "C:\\Temp\\3\\Rtmpy0iEMM\\vbar52806b866a5f"</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="../reference/script_dir.html">script_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "importData.vbs"</span></span></code></pre>
<p>Using <code><a href="../reference/macro_function.html">macro_function()</a></code> allows macros to be called like
any other R function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_file2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xlsm"</span><span class="op">)</span>, mustWork <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">macro_fun</span><span class="op">(</span><span class="va">dummy_file</span>, <span class="st">"first_sheet"</span>, <span class="st">"A1"</span>, <span class="va">output_file2</span><span class="op">)</span></span></code></pre></div>
<p>When you open the resulting Excel file, you should see the dummy data
written to sheet “first_sheet” starting at cell A1.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">shell.exec</span><span class="op">(</span><span class="va">output_file2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="common-problems">Common Problems<a class="anchor" aria-label="anchor" href="#common-problems"></a>
</h2>
<p>VBScript is is fairly sensitive to syntax and type errors, and has
only rudimentary support for error handling. Below is a list of common
problems in VBScripts:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Macros are not enabled in the file</strong>. Unsurprisingly,
attempting to run macros from a file that has macros disabled will
result in an error. Some methods of copying Macro-Enabled files will
remove digital signatures from the files, disabling macros.</li>
<li>
<strong>Mixed formatting in file paths</strong>. While VBScript can
handle file paths that use either <code>/</code> or <code>\</code>, it
cannot handle file paths that use both. To avoid this problem, wrap any
file paths provided as macro arguments in <code><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath()</a></code>
to ensure consistent formatting. Note that <code><a href="../reference/macro_script.html">macro_script()</a></code>
and <code><a href="../reference/macro_function.html">macro_function()</a></code> will normalize the path to the macro
file internally.</li>
<li>
<strong>VBA errors</strong>. VBScript will not return errors thrown
by the macro code. Depending on how the macro is written, the error may
result in an interactive dialog box, which suspend the program rather
than closing it. Setting <code>Application.DisplayAlerts = False</code>
in your VBA macros will prevent the application from prompting the user
to save the file when an error is encountered, but errors must be
handled in the VBA macro in order to completely prevent interactive
dialogs and avoid VBScripts from hanging indefinitely. Unfortunately, I
do not know of a way to return values from a VBA macro back to VBScript
so the best-case scenario will be that the VBScript returns an “unknown
error” message.</li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Koohafkan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
